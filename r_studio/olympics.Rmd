---
title: "Olympics"
output: html_document
---


### Аннотация:

В данном исследовании проанализирована база данных участников олимпийских игр на всём протяжении их проведения с целью проверки некоторых гипотез. Результаты, полученные в данном анализе, несут в себе ценную статистическую информацию, открывающую взгляд на более широкую картину и позволяющую подтвердить и опровергнуть некоторые возникающие предположения.

### Введение:

Целью данного исследования является проверка выдвинутых гипотез на основе визуализаций, построенных с помощью статистического программного продукта "Rstudio". Предметом анализа будет являться огромная база данных участников олимпийских игр за всю историю их проведения. В ней указаны возраст, пол, вес, рост, страна, вид спорта, название олимпийских игр, год их проведения, цвет заработанной медали и другая полезная информация. С помощью подходящего набора инструментов нам предстоит определить некоторые закономерности и зависимости, затрагивающие гендерные и возрастные вопросы, распределения заработанных медалей, физических параметров участников, различные страны и виды спорта олимпийских игр.

### Подготовка данных к анализу:

Подключение необходимых библиотек:

```{r}
library(tidyverse)
library(forcats) 
library(scales) 
library(readr)
library (dplyr)
library (ggplot2)
library (knitr)
```

Загрузка базы данных:

```{r}
athlete_events <- read_csv("./athlete_events.csv")
View(athlete_events)
```

Число строчек с пропущенным возрастом спортсмена:

```{r}
sum(is.na(athlete_events$Age))
```
Число строчек с пропущенным массой спортсмена:

```{r}
sum(is.na(athlete_events$Weight))
```
Число строчек с пропущенным ростом спортсмена:

```{r}
sum(is.na(athlete_events$Height))
```
Число строчек с пропущенным цветом медали спортсмена:

```{r}
sum(is.na(athlete_events$Medal))
```

**Ответ:** удалось установить, что в базе данных во многих строках отсутствует информация о цвете медали, полученной участником олимпийских игр, и/или их характеристики, и/или возраст. Тем не менее, избавляться от строчек, которые содержат пропущенные значения - нельзя, так как при отсутствии одного параметра присутствует другой, который может быть полезен при анализе. Присвоить среднее значение пропущенным ячейкам тоже нельзя, так как нецелесообразно усреднять рост, вес и возраст, так как данные характеристик носят исключительно индивидуальный характер, а цвет медали и вовсе качественный параметр. Таким образом, при последующем анализе будет более уместно фильтровать (исключать) те строчки, в которых отсутствуют данные необходимые для проведения именно текущего анализа.

### Разведочный анализ данных:

**1) Изменение количества женщин, участвующих в соревнованиях и его причины?** 

```{r}
athlete_events %>% filter(Sex=="F") %>%
  ggplot(athlete_events, mapping = aes(x=Year)) +
    geom_histogram(fill="#69b3a2", color="#e9ecef", alpha=0.9)+
      scale_x_continuous(breaks=seq(1896, 2020, by = 8))+
       labs (x="Год", y ="Число участвующих женщин, чел.")
```



**Ответ:** как можно заметить: женщины начали участвовать в олимпиадах только с 1900 года, и их количество с годами несёт в себе возрастающий тренд. Два пробела в гистограмме свидетельствует о том, что в 1916 олимпийские игры вовсе не проводились из-за Первой мировой войны и в период с 1940-1944 - по причине Второй мировой войны. Также можно отметить резкий скачок в числе женщин, принимающих участие в олимпийских играх, в конце 80-ых годов XX века, который был связан с разгаром второй волны феминизма, при которой уже равные в юридических правах женщины ещё и стали свободными от гендерных предрассудков в обществе. Небольшой спад в количестве участвующих женщин в 2016 можно объяснить вспышкой вируса Зика, оказывающего разрушительное влияние на репродуктивную систему женского организма, в Латинской Америке, где и проводились летние олимпийские игры. Таким образом, можно заявить, что есть стойкий возрастающий тренд участия женщин в олимпийских играх, что говорит о том, что всё больше девушек интересуются профессиональным спортом и хотят построить на нём свою карьеру.

**2) Определение стран с наибольшим количеством спортсменов с золотыми медалями сквозь года:**

```{r}
  athlete_events %>% 
  filter(Medal=="Gold") %>%
  group_by(Team) %>%
  tally() %>%
  top_n(10) %>%
  ggplot(athlete_events, mapping = aes(x=reorder(Team, -n), y=n)) +
    geom_bar(fill="#69b3a2", color="#e9ecef", alpha=0.9, stat = "identity")+
     labs(x="Страна", y="Количество золотых медалей, шт.")
```

**Ответ:** на столбиковой диаграмме представлены 10 стран с наибольшим количеством спортсменов с золотыми медалями сквозь года: США, СССР, Германия, Италия, Великобритания, Франция, Швеция, Венгрия, Канада и ГДР. Хотелось бы отметить, что США лидируют в данной номинации, намного опережая своих конкурентов, собрав чуть меньше 2500 медалей, в то время как СССР, которому принадлежит второе место, смог получить чуть больше 1000 медалей.

**3) Виды спорта с наибольшим количеством золотых медалей:**

```{r}
 athlete_events %>% 
  filter(Medal=="Gold") %>%
  group_by(Sport) %>%
  tally() %>%
  top_n(10) %>%
  ggplot(athlete_events, mapping = aes(x=reorder(Sport, -n), y=n)) +
    geom_bar(fill="#69b3a2", color="#e9ecef", alpha=0.9, stat = "identity")+
     labs(x="Вид спорта", y="Количество золотых медалей, шт.", title="За весь период")
```

```{r}
athlete_events %>% filter(Medal=="Gold" & (Sport=="Athletics" | Sport=="Swimming" | Sport=="Rowing")) %>%
  ggplot(athlete_events, mapping = aes(x=Year)) +
    geom_histogram(aes(fill=Sport), position = "fill", binwidth=4)+
      scale_x_continuous(breaks=seq(1895, 2020, by = 10))+
     labs(x="Год", y="Доля полученных золотых медалей", fill="Вид спорта", title="В динамике (3 лидера)")
```

**Ответ:** как можно заметить: лёгкая атлетика, плавание, гребля и другие виды спорта, указанные на столбиковой диаграмме, относятся к видам спорта с наибольшим количеством золотых медалей у спортсменов. Победа лёгкой атлетики в этой номинации объясняется большим разнообразием состязаний в пределах её области, плавания - наличием различных стилей и разных дистанций, гребли - наличием разных дистанций и командностью, при которой каждый спортсмен получает медаль при победе команды, а также в ТОП-10 входит множество командных видов спорта, где опять же награждается каждый участник команды.

Помимо этого, на основе гистограммы можно сделать вывод о том, что примерно в начале 50-ых годов XX века атлетика перестала быть самым "золотым" видом спорта для спортсменов, уступив своё место плаванию. Это объясняется с развитием плавания как спорта в целом, а также и технологий, которые используются для содержания бассейнов и проведения состязаний в нём.

**4) Средние характеристики у спортсменов (рост и вес), взаимосвязь характеристик и цвета полученной медали, стандартные характеристики для плавания и гимнастики:**

Средний рост всех участников:

```{r}
mean (athlete_events$Height, na.rm=TRUE)
```


Средний вес всех участников:

```{r}
mean (athlete_events$Weight, na.rm=TRUE)
```

```{r}
athlete_events %>% filter(!(is.na(Weight)==TRUE) & !(is.na(Medal)==TRUE)) %>%
  ggplot(athlete_events, mapping = aes(x=Weight)) +
    geom_bar(aes(fill=Medal), position="fill", binwidth=5)+
      scale_x_continuous(breaks=seq(0,200, by = 10))+
       labs (x="Масса, кг", y ="Доля всех выигранных медалей", title="Зависимость массы спортсмена от цвета медали", fill="Цвет медали")
```

```{r}
athlete_events %>% filter(!(is.na(Height)==TRUE) & !(is.na(Medal)==TRUE)) %>%
  ggplot(athlete_events, mapping = aes(x=Height)) +
    geom_bar(aes(fill=Medal), position="fill", binwidth=5)+
      scale_x_continuous(breaks=seq(0,300, by = 10))+
       labs (x="Рост, см", y ="Доля всех выигранных медалей", title="Зависимость роста спортсмена от цвета медали", fill="Цвет медали")
```



```{r}
athlete_events %>% filter((Sport=="Gymnastics" | Sport=="Swimming") & !(is.na(Weight)==TRUE)) %>%
  ggplot(athlete_events, mapping = aes(x=Sport, y=Weight)) + 
    geom_boxplot(fill="slateblue", alpha=0.2)+
  labs (x="Вид спорта", y="Масса, кг", title="Стандартная масса спортсмена-гимнаста и спортсмена-пловца")
```

```{r}
athlete_events %>% filter((Sport=="Gymnastics" | Sport=="Swimming") & !(is.na(Height)==TRUE)) %>%
  ggplot(athlete_events, mapping = aes(x=Sport, y=Height)) + 
    geom_boxplot(fill="slateblue", alpha=0.2) +
  labs (x="Вид спорта", y="Рост, см", title="Стандартный рост для спортсмена-гимнаста и спортсмена-пловца")
```

**Ответ:** удалось установить, что средний рост всех спортсменов составляет 175.34 см, масса - 70,7 кг. Также с помощью анализа стало известно, что никакая из перечисленных ранее характеристик участников (рост и вес) практически не играет никакой роли в цвете медалей, получаемых ими. Помимо этого, при сравнении физических параметров спортсменов-гимнастов и спортсменов-пловцов удалось установить, что средние масса и рост гимнастов (57 кг и 163 см) меньше тех же характеристик пловцов (70,5 кг и 178,6 см), а также у вторых разброс значений к завышению больше, что может объясняться тем, что в гимнастике высокий рост и большая мышечная масса скорее представляются препятствиями в связи со спецификой данного вида спорта, в то время как в плавании - наоборот.

**5) Изменение количества спортсменов мужского и женского полов сквозь года от каждой страны, пропорции и причины:**

```{r}
  ggplot(athlete_events, mapping = aes(x=Year)) +
    geom_histogram(fill="#69b3a2", color="#e9ecef", alpha=0.9)+
      scale_x_continuous(breaks=seq(1895, 2020, by = 20))+
       labs (x="Год", y ="Число участников, чел.", title="Общее число участников сквозь года")
```

```{r}
  ggplot(athlete_events, mapping = aes(x=Year)) +
    geom_histogram(aes(fill=Sex), position = "fill")+
      scale_x_continuous(breaks=seq(1895, 2020, by = 10))+
      labs(x="Год", y="Доля участников обоих полов", fill="Пол", title="В гендерном разрезе")
```

**Ответ:** таким образом, выше приведённые диаграммы демонстрируют то, количество участников с ходом времени носит возрастающий тренд, что объясняется повышенным интересом к профессиональному спорту в обществе в целом. Также стало известно, что со временем число участников-женщин немного сравнялось с числом участниками-мужчинами. В последние годы в олимпийских играх принимали участие как около 10000 мужчин (56,25%), так и около 8000 женщин (43,75%), в то время как в самом начале проведения состязаний, когда женщины даже не обладали полным набором юридических прав, участвовали только мужчины. Тем не менее, можно сказать, что в профессиональном спорте на сегодняшний момент есть тенденция к равноправию, когда участники обоих полов проявляют свои таланты в равных пропорциях.

**6) Самый молодой и взрослый участник, распределение возрастов спортсменов, влияние возраста на цвет медали:**

Самый молодой участник:

```{r}
str (athlete_events[which.min(athlete_events$Age),])
```

Самый старый участник:

```{r}
str (athlete_events[which.max(athlete_events$Age),])
```

```{r}
athlete_events %>% filter(!(is.na(Age)==TRUE)) %>%
  ggplot(athlete_events, mapping = aes(x=Age)) +
    geom_bar(aes(stat="identity"), fill="#69b3a2", color="#e9ecef", alpha=0.9)+
    scale_x_continuous(breaks=seq(0, 100, by = 5))+
     labs(x="Возраст, лет (год, года)", y="Число участников, чел.", title="Распределение количества участников по возрастам")
```

```{r}
athlete_events %>% filter(!(is.na(Age)==TRUE) & !(is.na(Medal)==TRUE)) %>%
  ggplot(athlete_events, mapping = aes(x=Age)) +
    geom_bar(aes(stat="identity", fill=Medal), position="fill", alpha=0.9)+
    scale_x_continuous(breaks=seq(0, 100, by = 5))+
     labs(x="Возраст, лет (год, года)", y="Доля заработанных медалей", title="Зависимость возраста от цвета медали", fill="Цвет медали")
```

**Ответ:** самым молодым участником является мальчик-гимнаст 10-ти лет, а самым старым - 97-летний мужчина в художественных состязаниях. Как можно заметить, возраст большинства участников - 20-28 лет, а самый популярный возраст среди участников - около 24 года, что объясняется пиком физических способностей в этом возрасте. Также удалось установить, что возраст участника практически никак не влияет на цвет заработанной им медали, но всё же после люди после 65 лет, как правило, уже не получают золотые медали.

### Итоговые результаты и выводы:

**Наиболее статистические важные визуализации:**

```{r}
  athlete_events %>% 
  filter(Medal=="Gold") %>%
  group_by(Team) %>%
  tally() %>%
  top_n(10) %>%
  ggplot(athlete_events, mapping = aes(x=reorder(Team, -n), y=n)) +
    geom_bar(fill="#69b3a2", color="#e9ecef", alpha=0.9, stat = "identity")+
     labs(x="Страна", y="Количество золотых медалей, шт.", title="Распределение золотых медалей по странам")
```

```{r}
  ggplot(athlete_events, mapping = aes(x=Year)) +
    geom_histogram(aes(fill=Sex), position = "fill")+
      scale_x_continuous(breaks=seq(1895, 2020, by = 10))+
      labs(x="Год", y="Доля участников обоих полов", fill="Пол", title="Пропорция участников в гендерном разрезе")
```

```{r}
athlete_events %>% filter(!(is.na(Age)==TRUE)) %>%
  ggplot(athlete_events, mapping = aes(x=Age)) +
    geom_bar(aes(stat="identity"), fill="#69b3a2", color="#e9ecef", alpha=0.9)+
    scale_x_continuous(breaks=seq(0, 100, by = 5))+
     labs(x="Возраст, лет (год, года)", y="Число участников, чел.", title="Распределение количества участников по возрастам")
```

**Вывод: таким образом, в процессе исследования нам удалось установить, что с большим отрывом участники от США являются обладателями наибольшего числа золотых медалей, обгоняя СССР более чем в два раза, который держит второе место. Также наблюдаются тенденции к гендерному равенству в олимпийских играх - число участников-женщин неуклонно росло в течение более сотни лет и уже практически сравнялось с мужчинами. Помимо этого, удалось сделать умозаключение о том, что большинство участников олимпийских игр - это люди 20-28 лет, а самым молодым спортсменом за всю историю был 10-летний мальчик-гимнаст, самым старым - 97-летний мужчина-артист. Более того, гипотезы о влиянии возраста и физических характеристик атлета на шансы получения медали не подтвердились - они практически никак не влияют на это. Ещё нам удалось определить, что Лёгкая атлетика, плавание и гребля являются наиболее популярными видами спорта по количеству полученных золотых медалей, а также изучить разницу в средних физических параметров спортсменов разных видов спорта.**

**В заключение хотелось бы сказать, что полученные нами результаты несут в себе статистически полезны и интересны для изучения. К сожалению, существуют некоторые ограничения с используемыми данными, например, в связи с конфигурацией Rstudio размер визуализации ограничен, поэтому при расположении на осях множества объектов массива (страны, виды спорта) метки слипаются, и чтение диаграмм становится невозможным, приходилось прибегать к ограничению объёма исследуемых данных. Тем не менее, с помощью данного исследования можно заявить о том, что некоторые популярные выдвигаемые гипотезы были отвергнуты, а какие-то неочевидные закономерности были зафиксированы. Эти результаты могут быть использованы с целью просвещения широкой аудитории о специфике культуры олимпийских игр, чтобы предоставить ей более широкий взгляд на профессиональный спорт.**
